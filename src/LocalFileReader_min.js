function RtwFileReader(e){if(this.ReadMode={ARRAY_BUFFER:"a",BINARY:"b",DATA_URL:"d",TEXT:"t"},this.ErrorTexts={FILE_API_UNSUPPORTED:"File APIs unsupported: File, FileReader, FileList or Blob is missing",UNEXPECTED_READ_MODE:"Unexpected read mode: check if the input value matches the ReadMode enumeration"},!(window.File&&window.FileReader&&window.FileList&&window.Blob))throw new Error(this.ErrorTexts.FILE_API_UNSUPPORTED);this._fileBuffer=[],this._filesInQueue=0,this._callbacks={onReadCompleted:e.readCompleted||null},this.getFiles=function(){return this._fileBuffer},this.getFile=function(e){return this._fileBuffer[e]||null},this.read=function(e,i){var t,r,s;this._filesInQueue=e.length;for(var a=0;a<e.length;a++){switch(t={file:e[a],content:"",readMode:Array.isArray(i)&&i[a]?i[a]:void 0},r=new FileReader,r.addEventListener("loadend",function(e,i){i.target.readyState===FileReader.DONE&&(e.content=i.target.result,this._filesInQueue--,0===this._filesInQueue&&this._callbacks.onReadCompleted&&this._callbacks.onReadCompleted(this._fileBuffer))}.bind(this,t)),s=t.readMode||i||this.ReadMode.TEXT){case this.ReadMode.ARRAY_BUFFER:r.readAsArrayBuffer(t.file);break;case this.ReadMode.BINARY:r.readAsBinaryString(t.file);break;case this.ReadMode.DATA_URL:r.readAsDataURL(t.file);break;case this.ReadMode.TEXT:r.readAsText(t.file);break;default:throw new Error(this.ErrorTexts.UNEXPECTED_READ_MODE)}this._fileBuffer.push(t)}},this.clear=function(){for(;this._fileBuffer.length>0;)this._fileBuffer.pop();this._filesInQueue=0},this.readAsArrayBuffer=function(e){this.read(e,this.ReadMode.ARRAY_BUFFER)},this.readAsBinary=function(e){this.read(e,this.ReadMode.BINARY)},this.readAsDataURL=function(e){this.read(e,this.ReadMode.DATA_URL)},this.readAsText=function(e){this.read(e,this.ReadMode.TEXT)},e.files&&e.files.length>0&&this.read(e.files,e.readMode)}
